<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"><title></title>
    <link rel="stylesheet" href="demo.css"/>
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    $if{dev}<script src="http://localhost:12321/livereload.js"></script>{/}
  </head>
  <body>
    <!-- <iframe id="demo-iframe" src="https://www.chanel.com/es_ES/"></iframe> -->
    <header class="header">
      <div class="container">
        <div class="inline-block">
          <a class="logo-link" href="/">
            <img src="/assets/images/logo.svg" alt="aplazame logo"/>
            <span>|</span><span class="docs">Demo</span>
          </a>
        <div>
      </div>
    </header>

    <div class="sections">

      <section class="container">

        <h2>Simulador de cuotas</h2>

        $with{ checkout.order.articles[1] as article }
          <article class="row article-sample">
            <div class="col-sm-6 img-wrapper">
              <img src="${article.image_url}" alt="${article.name}"/>
            </div>
            <div class="col-sm-6 details">
              <div class="label">${article.name}</div>
              <p class="description">${article.description}</p>
              <div class="price">${ toEUR(article.price) }</div>

              <br/>
              <hr/>

              <div class="col-md-offset-4 col-md-8">
                <div data-aplazame-simulator="" data-amount="${article.price}"></div>
              </div>

            </div>
          </article>
        {/}
      </section>

      <section class="container cart-list">

        <h2>Carrito de compra</h2>

        <ul>
        $each{ article in checkout.order.articles }
          <li class="row">
            <div class="col-sm-3 text-center">
              <div class="img-wrapper">
                <img src="${article.image_url}" alt="${article.name}"/>
              </div>
            </div>
            <div class="col-sm-9 details">
              <div class="label">${article.name}</div>
              <div class="price-wrapper">
                $if{ article.quantity > 1 }<span class="quantity">${article.quantity}x&nbsp;</span>{/}
                <span class="price">${ toEUR(article.price) }</span>
              </div>
            </div>
          </li>
        {/}
        </ul>

        <div class="total-wrapper">
          <div class="label">Total</div>
          <div class="price-wrapper">
            <span class="price">${ toEUR( totalPrice(checkout.order.articles) ) }</span>
          </div>
        </div>

        <div class="pay-with-aplazame">

          <button data-aplazame-button-info="default" onclick="loadCheckout();">
            <span>Pagar con&nbsp;</span><img src="/assets/images/logo.svg"/>
          </button>

          <!-- <button data-aplazame-button-info="default" onclick="loadCheckout();">
            <img src="dist/widgets/assets/img/aplazame-checkout.svg"/>
          </button> -->
        </div>

      </section>

    </div>

    <footer class="footer">
      <div class="container">
        <span>&copy;&nbsp;Aplazame S.L.</span>
      </div>
    </footer>

    <script type="text/javascript"
            src="dist/aplazame.js?sandbox=true"
            data-aplazame="f5f64b3e9c7d8da5de29d4a45f40d370282f6f05"
            data-version="v1.2"
            data-sandbox="true">
    </script>
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>

    <script type="text/javascript">
      var loadCheckout = (function () {

        var checkoutdata = ${ JSON.stringify(checkout, null, '\t') };

        function randOrderId (timeout) {
          return 'test-' + parseInt( new Date().getTime() / ( timeout || 60000 ) );
        }

        function loadCheckout(orderId) {

          if( !orderId ) {
            location.search = 'order=' + randOrderId();
            return;
          }

          checkoutdata.order.id = orderId;

          aplazame.checkout(checkoutdata);
        }

        var matchOrderId = ( location.search || '' ).match(/order\=([^&]*)/);

        if( matchOrderId && matchOrderId[1] ) {
          loadCheckout( matchOrderId[1] === 'random' ? randOrderId(1) : matchOrderId[1] );
        }

        return loadCheckout;

      })();
    </script>
  </body>
</html>
